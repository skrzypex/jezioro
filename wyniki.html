<script>
async function loadResults() {
  try {
    const res = await fetch('/api/vote');
    const data = await res.json();

    const container = document.getElementById('results');

    for (const category in data) {
      const participants = Object.entries(data[category])
        .sort((a,b) => b[1] - a[1]) // sortuj malejąco
        .slice(0,3); // top 3

      const div = document.createElement('div');
      div.className = 'category';

      div.innerHTML = `<h2>${category}</h2>` +
        participants.map(([name,votes], i) => `<p>${i+1}. ${name} – ${votes} głosów</p>`).join('');

      container.appendChild(div);
    }
  } catch(err) {
    console.error(err);
  }
}

window.onload = loadResults;
</script>
